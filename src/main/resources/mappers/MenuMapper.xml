<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.itsu.spbmanagevue.dao.MenuDAO">
    <cache eviction="LRU" flushInterval="600000" readOnly="true" size="512"/>

    <select id="getUserMenuByUserName" useCache="true" parameterType="java.lang.String"
            resultType="com.itsu.spbmanagevue.entity.Menu">
        select a.*
        from tb_menu a
                 JOIN tb_role_menu b on a.menu_id = b.mid
                 join tb_role c on b.rid = c.rid
                 join tb_user d on c.rid = d.rid
        where d.username = #{value}

    </select>

    <select id="getMenuButton" useCache="true" parameterType="java.lang.Integer" resultType="java.lang.Integer">
        select b.id
        from tb_menu a
                 join tb_button b on a.menu_id = b.mid
        where a.menu_id = #{menuId}
    </select>
</mapper>